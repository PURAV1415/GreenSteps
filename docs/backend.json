{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user in the EcoTrack application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user entity, matches Auth UID."
        },
        "name": {
          "type": "string",
          "description": "User's full name."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "department": {
          "type": "string",
          "description": "User's department within the campus."
        },
        "campus": {
          "type": "string",
          "description": "User's campus."
        },
        "totalPoints": {
          "type": "number",
          "description": "User's all-time total points."
        },
        "totalEmissions": {
          "type": "number",
          "description": "User's all-time total emissions in kg CO₂."
        },
        "streak": {
          "type": "number",
          "description": "User's current daily login streak."
        },
        "milestones": {
          "type": "object",
          "properties": {
            "walked": { "type": "number" },
            "cycled": { "type": "number" }
          }
        }
      },
      "required": ["id", "name", "email", "department", "campus", "totalPoints", "totalEmissions"]
    },
    "DailyData": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "DailyData",
      "type": "object",
      "description": "Represents a user's consolidated daily transport and metrics.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the daily entry (e.g., YYYY-MM-DD)."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User."
        },
        "date": {
          "type": "string",
          "description": "Date of the entry (YYYY-MM-DD).",
          "format": "date"
        },
        "mode": {
          "type": "string",
          "description": "Mode of transport used."
        },
        "distance": {
          "type": "number",
          "description": "Distance traveled in kilometers."
        },
        "trips": {
          "type": "number",
          "description": "Number of trips made."
        },
        "emissions": {
          "type": "number",
          "description": "Carbon emissions for the day in kg CO₂."
        },
        "points": {
          "type": "number",
          "description": "Points earned for the day."
        }
      },
      "required": ["id", "userId", "date", "mode", "distance", "trips", "emissions", "points"]
    },
    "Leaderboard": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Leaderboard",
      "type": "object",
      "description": "Represents leaderboard data for a single user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the leaderboard entry, matches Auth UID."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User."
        },
        "name": {
          "type": "string",
          "description": "Denormalized user name for quick display."
        },
        "department": {
          "type": "string",
          "description": "Denormalized department for filtering."
        },
        "campus": {
          "type": "string",
          "description": "Denormalized campus for filtering."
        },
        "totalPoints": {
          "type": "number",
          "description": "Total points earned by the user."
        },
        "dailyPoints": {
          "type": "number",
          "description": "Points earned by the user today."
        }
      },
      "required": ["id", "userId", "name", "department", "campus", "totalPoints", "dailyPoints"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/entities/User"
          },
          "description": "Stores user profile and aggregate data."
        }
      },
      {
        "path": "/users/{userId}/dailyData/{dailyDataId}",
        "definition": {
          "entityName": "DailyData",
          "schema": {
            "$ref": "#/entities/DailyData"
          },
          "description": "Stores time-series data for a user's daily activities."
        }
      },
      {
        "path": "/leaderboard/{leaderboardId}",
        "definition": {
          "entityName": "Leaderboard",
          "schema": {
            "$ref": "#/entities/Leaderboard"
          },
          "description": "Denormalized data for efficient leaderboard queries. The document ID should match the user's UID."
        }
      }
    ],
    "reasoning": "The structure is user-centric, storing all personal data under `/users/{userId}`. The `dailyData` subcollection holds time-series metrics, which is efficient for historical charts. The top-level `leaderboard` collection is denormalized, containing all necessary data (`name`, `department`, `points`) to build leaderboards without requiring expensive joins or multiple reads, ensuring queries are fast and scalable."
  }
}
